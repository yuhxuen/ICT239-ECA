{% extends "base.html" %} {% block mainblock %} {% if not bundles or
bundles|length == 0 %}
<div class="p-4 h5">No Purchased Bundle</div>
{% else %} {% for b in bundles %}
<!-- full faint grey line between bundles -->
<div class="row px-3 py-2" style="border-top: 1px solid #e9ecef">
  <div class="col-md-2 small">
    <div>
      <strong>Purchase Date</strong><br />{{ b.purchased_date|formatdate }}
    </div>
    <div class="mt-2">
      <strong>Expiry date</strong><br />{{ b.expiry_date|formatdate }}
    </div>
    {% if b.is_expired() %}
    <div class="text-danger mt-2">Expired</div>
    {% endif %}
  </div>

  <div class="col-md-10">
    <!-- partial faint lines between packages inside a bundle -->
    {% for item in b.bundledPackages %}
    <div
      class="row align-items-center py-2"
      style="border-bottom: 1px solid #f8f9fa"
    >
      <div class="col-md-1">
        <img src="{{ item.package.image_url }}" class="img-fluid" />
      </div>

      <div class="col-md-7">
        <div class="font-weight-bold">{{ item.package.hotel_name }}</div>
        {% if b.is_expired() %}
        <div class="text-muted">Expired</div>
        {% elif item.utilised %}
        <div>Utilised: Yes</div>
        {% else %}
        <div>Utilised: Not Yet</div>
        {% endif %}
      </div>

      <div class="col-md-4 text-right">
        {% if (not b.is_expired()) and (not item.utilised) %}
        <form
          action="/manageBundle/book"
          method="post"
          class="form-inline justify-content-end"
        >
          <input type="hidden" name="bundle_id" value="{{ b.id }}" />
          <input
            type="hidden"
            name="package_id"
            value="{{ item.package.id }}"
          />
          <input
            type="date"
            name="check_in_date"
            class="form-control form-control-sm mr-2"
            required
          />
          <button type="submit" class="btn btn-primary btn-sm">Book</button>
        </form>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endfor %} {% endif %} {% endblock %}
